<!--Insert information gathered into the database with admin perms:-->
<!DOCTYPE html>
<html>
<?php include"setup_sec.php";foreach($_POST as&$value){$value=str_replace("'","\'",$value);}$sql="SELECT * FROM ANALYTICS WHERE pagenum = ".$_POST["pagenum"];$result=$conn_sec->query($sql);if(mysqli_num_rows($result)==0){$sql="INSERT INTO `analytics` (`id`, `pagenum`, `hits`) VALUES (NULL, '".$_POST["pagenum"]."', '0');";$conn_sec->query($sql);}$sql="";$i=0;while(true){if(isset($_POST["title".$i])){if(!isset($_POST["pagenum".$i])){$_POST["pagenum".$i]=$_POST["pagenum"];}$sql=$sql."INSERT INTO media (pagenum, title, url, text, size, display) VALUES ('".$_POST["pagenum".$i]."', '".$_POST["title".$i]."', '".$_POST["url".$i]."', '".$_POST["text".$i]."', '".$_POST["size".$i];if($_POST["display".$i]=="video"){$sql=$sql."', 'video";}else{$sql=$sql."', 'text";}$sql=$sql."'); ";$i++;}else{break;}}echo($sql);$illegal=["<script>","</script>","<?php","?>"];foreach($illegal as $hack){if(strpos($sql,$hack)!==false){echo "<p style=\"color: red\"size=\"5rem\">Illegal characters used: \"&ltscript&gt\", \"&lt/script&gt\", \"&lt?php\", \"?&gt\" are not permitted for security reasons.";die();}}if($conn_sec->multi_query($sql)===true){echo "<p style=\"color: #63ebb0\"size=\"5rem\">New record created successfully in database.</p>";}else{echo "Error: ".$sql."<br>".$conn_sec->error;echo "No changes have been made.";}$conn_sec->close(); ?><meta http-equiv="refresh" content="0;url=admin.php"></html>